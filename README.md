# Sysy-compiler
此项目为西北工业大学计算机学院编译原理试点班大作业

主要参考了北京大学编译原理文档，链接如下：

https://pku-minic.github.io/online-doc/#/preface/

实现了Sysy的全部语法，能过通过编译原理大赛2020版全部测试样例，在`function_test2020/`文件夹下有全部的测试样例，同时我编写了一个简单的测试脚本，为`test.py`.

前端使用llvm完成IR的构建，独立设计完成了AST。后端由于时间原因没有自己完成从IR到汇编语言、可执行文件的整体流程，而是使用了llvm的函数。

同时简单完成了一点优化，不过由于时间匆忙，优化部分仍有一些bug

代码的详细介绍在本项目中的实验报告中

代码质量后期不高，在CFG分析部分没有形成一个成体系的分析逻辑，由于精力限制没有继续优化.

# 项目依赖

llvm 10.0.0

## AST介绍

此处介绍所有定义的AST以及其封装层次，最终的作用

`BaseAST` : 所有AST的父类，定义了基础的函数以及性能

`CompUnitAST` ：一个编译模板，其中有多个函数，`FuncDefAST`

`FuncDefAST` ：一个函数的定义，其中包括一个基础块，`BlockAST`

`BlockAST`：一个基础块的定义，其中包括多个声明，`StmtAST`

`StmtAST`：一个声明的定义，其可以为一句话，也可能包括一个`BlockAST`，取决于这个声明是不是`if` `while`等类型

## IR生成

这部分使用的是定义一个IR类，通过遍历AST的方式实现IR的生成，这里主要使用了llvm的相关api。这方面细节比较多，是在过测试样例的过程中一点点修正的bug，代码质量没有那么的高。
